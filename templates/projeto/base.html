<!DOCTYPE html>
<html lang="pt-br">

{% load static %}
{% load humanize %}


<head>
    <base href="./">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=0.7 maximum-scale=0.8">
    <title>PIN Venda+</title>
    <link rel="icon" href="{% static 'img/icons/inteliger.ico' %}"/>

    <!-- Css Font awesome -->
    <link rel="stylesheet" href="{% static 'css/font-awesome/css/font-awesome.css' %}">

    <!-- Css do componente Select2 -->
    <link rel="stylesheet" href="{% static 'select2/css/select2.css' %}">

    <!-- Ícones -->
    <link rel="stylesheet" href="{% static 'css/fontface/icone_pin/icone_menu/icons_menu.css' %}">
    <link rel="stylesheet" href="{% static 'css/fontface/icone_pin/icons_pin.css' %}">

    <!-- Css Booststrap -->
    <link rel="stylesheet" href="{% static 'bootstrap-4.4.1/dist/css/bootstrap.min.css' %}">
    <!-- Cores utilizadas no projeto -->
    <link rel="stylesheet" href="{% static 'css/cores.css' %}">
    <!-- Quatro menus principais -->
    <link rel="stylesheet" href="{% static 'css/quatro_menus.css' %}">
    <!-- Styles -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">

    {% block css_tabela %}
        <!-- Css tabelas -->
        <link rel="stylesheet" href="{% static 'devextreme/css/datatables.min.css' %}">
    {% endblock %}

    <!-- Toastr, Alerta de sucesso ou error css -->
    <link rel="stylesheet" href="{% static 'toastr/css/toastr.css' %}">



    {% block css %}
    {% endblock %}

</head><!-- head -->


<body class="app header-fixed sidebar-minimized aside-menu-minimized sidebar-lg-show">
<!-- Div que possui o css para carregamento da página -->
<div class="loaderBase"></div>

{% block app_header %}
    <header class="app-header navbar">

        <div class="d-flex justify-content-start">
            <!-- Início dos botões abre e fecha menu esquerdo -->
            <!-- Fecha -->
            <button id="btn_Fecha_Menu_Esquerdo" class="navbar-toggler sidebar-toggler d-lg-none mr-auto" type="button" value="0" data-toggle="sidebar-show">
                <span class="navbar-toggler-icon"></span>
            </button>
            <!-- Abre -->
            <button id="btn_Abre_Menu_Esquerdo" class="sidebar-minimizer brand-minimizer d-md-down-none isDisabled" type="button" value="0" data-toggle="sidebar-lg-show">
                <span class="navbar-toggler-icon"></span>
            </button>
            <!-- Fim dos botões abre e fecha menu esquerdo -->

            <!-- Início Logo -->
            <a class="navbar-brand" href="#">
                <img src="{% static 'img/logos_e_banners/logo-PIN-venda-mais.svg' %}" alt="PIN logo">
            </a>
            <!-- Fim Logo -->
        </div>

        <!-- Início dos botões abre e fecha menu direito -->
        <div class="text-right d-flex flex-nowrap align-items-center">

            <!-- Início Ícone no menu de aplicativos do sistema -->
            <a href="#" class="mr-2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <img src="{% static 'img/menus/icon_collapse-menu_venda+.svg' %}" alt="Ícone menuzinho" width="30">
            </a>
            <!-- Fim Ícone no menu de aplicativos do sistema -->

            <!-- Conteúdo no menu de aplicativos do sistema -->
            <div class="dropdown-menu dropdown-menu-right">
                <div class="d-flex justify-content-between">
                    <!-- Venda+ -->
                    <a href="https://vendamais.drogariasnissei.com.br" class="nav-link" target="_blank">
                        <img src="{% static 'img/menus/icons-submenu-header_venda-mais.svg' %}" alt="Ícone venda+" width="30">
                    </a>

                    <!-- Indicadores -->
                    <a href="https://pin.drogariasnissei.com.br/pin/login/" class="nav-link" target="_blank">
                        <img src="{% static 'img/menus/icons-submenu-header_indicadores.svg' %}" alt="Ícone indicador" width="30">
                    </a>
                    <a href="https://fornecedor.nisseisa.com.br/" class="nav-link" target="_blank">
                        <img src="{% static 'img/menus/icons-submenu-header_fornecedor.svg' %}" alt="Ícone fornecedor" width="30">
                    </a>
                </div><!-- .d-flex -->

                <div class="d-flex justify-content-between">
                    <!-- Acesso BO -->
                    <a href="https://bi.drogariasnissei.com.br:8080/BOE/BI" class="nav-link" target="_blank">
                        <img src="{% static 'img/menus/icon_bo.svg' %}" alt="Ícone BO" width="30">
                    </a>

                    <!--Memed-->
                    <a href="https://memed.com.br/receita/login" class="nav-link" target="_blank">
                        <img src="{% static 'img/menus/icons-submenu-header_memed.svg' %}" alt="Ícone memed" width="30">
                    </a>

                    <div style="width:65px"></div>
                </div><!-- .d-flex -->
            </div><!-- .dropdown-menu dropdown-menu-right -->
            <!-- Conteúdo no menu de aplicativos do sistema -->


            <!-- Foto do usuário -->
            <!-- Fecha -->
            <button class="navbar-toggler aside-menu-toggler d-md-down-none" type="button" data-toggle="aside-menu-lg-show">
                <img id="avatar1" class="img-avatar rounded-circle" src="{{ request.user.photo.url }}" alt="photo" width="40" height="40">
            </button>
            <!-- Abre -->
            <button id="btn_Abre_Menu_Direito" class="navbar-toggler aside-menu-toggler d-lg-none" type="button" data-toggle="aside-menu-show">
                <img id="avatar2" class="img-avatar rounded-circle" src="{{ request.user.photo.url }}" alt="photo" width="40" height="40">
            </button>
            <!-- Fim Foto do usuário -->
        </div>
        <!-- Fim dos botões abre e fecha menu direito -->
    </header>
{% endblock %}

{% block app_alertas %}

{% endblock %}

{% block app_body %}
    <div class="app-body">

        {% block menu_esquerdo %}
            <div class="sidebar">
                <nav class="sidebar-nav">
                    <ul class="nav" id="menu_esquerdo">

                    </ul>
                </nav>
            </div>
        {% endblock %}

        {% block breadcrumb %}
        {% endblock %}

        <main class="main">
            {% block main %}

            {% endblock %}
            <!-- Modal confirmação -->
            <div class="modal modal-sem-scroll" id="modal_confirmacao" tabindex="-1" data-backdrop="true" role="dialog" aria-labelledby="modal_confirmacao" aria-hidden="true">
                <div class="modal-dialog modal-md" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title "
                                id="exampleModalLongTitle"></h5>
                            <a class="icon_close p-1" data-dismiss="modal" aria-label="Close"></a>
                        </div>
                        <div class="modal-body text-center">
                            <p class="font-lg messageBody"></p>
                            <p class="text-muted messageMuted">Não será mais possível recupera-lo.</p>
                        </div>
                        <div class="modal-footer float-right">
                            <a class="btn btn-danger text-white seletorBtnAcao" tabindex="0">Excluir</a>
                            <a class="btn btn-outline-light" type="button" tabindex="0" data-dismiss="modal">Cancelar</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal alerta conteúdo não salvo -->
            <div class="modal modal-sem-scroll" id="modal_alerta" tabindex="0" role="dialog" data-backdrop="true" aria-labelledby="modal_alerta" aria-hidden="false">
                <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                    <div class="modal-content border-0">
                        <div class="modal-header">
                            <h5 class="modal-title font-weight-normal" id="exampleModalLongTitle">Deseja salvar as alterações feitas?</h5>
                            <a class="icon_close p-1" data-dismiss="modal" aria-label="Close"></a>
                        </div>
                        <div class="modal-body text-center">
                            <p class="font-lg messageBody">Seu conteúdo será perdido ao fechar esta janela</p>
                            <p class="text-muted">Não será mais possível recupera-lo.</p>
                        </div>
                        <div class="container-fluid border-top border-light">
                            <div class="mt-1 mb-2">
                                <div class="row pr-2 pl-2 d-flex justify-content-between align-items-center flex-wrap">
                                    <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 col-12 mt-1"></div>
                                    <div class="col-xl-8 col-lg-8 col-md-12 col-sm-12 col-12 mt-1">
                                        <div class="d-flex flex-nowrap btnsAcao">
                                            <a class="btn btn-primary w-100 text-white mr-1 px-3 seletorBtnSalvar" tabindex="0">Salvar</a>
                                            <a class="btn btn-outline-secondary w-100 mr-1 px-3" data-dismiss="modal" tabindex="0">Cancelar</a>
                                            <a class="btn btn-danger w-100 text-white mr-1 px-3 seletorBtnNaoSalvar" tabindex="0">Não Salvar</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal Versão atual -->
            <div class="modal fade" id="modalVersaoAtual" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                        <div class="modal-header">

                            <h5 class="modal-title" id="exampleModalLongTitle">Versão {{ versao_atual.versao.codigo }}</h5>
                            <button type="button" class="close-modal" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>

                        <div class="modal-body">
                            {% if versao_atual.versao.descricao != None %}
                                <p>{{ versao_atual.versao.descricao }}</p>
                                <hr>
                            {% endif %}

                            <h5 class="text-left font-weight-normal mt-2 text-body">Detalhes da atualização</h5>
                            <br>
                            <ul class="list-group">
                                {% for item in versao_atual.itens %}
                                    <li>- {{ item.descricao }}{% if forloop.last %}.{% else %};{% endif %}</li>
                                {% endfor %}
                            </ul>

                        </div>
                        <div class="modal-footer d-flex justify-content-between align-content-center">
                            <a href="#">
                                Ir para todas as versões
                            </a>
                            <a class="btn btn-outline-light mr-2"
                               data-dismiss="modal">Fechar essa janela
                            </a>
                        </div>
                    </div>
                </div>
            </div><!-- Modal versão PIN -->

        </main>

        {% block menu_direito %}
            <aside class="aside-menu">

                <ul class="nav nav-tabs" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active"  tabindex="-1" data-toggle="tab" href="#loja" role="tab">
                            <span class="icon_add-store font-2xl"></span>
                        </a>
                    </li>
                    {% if 'acessar_pg_dev' in request.session.usr_info.pt_funcao %}
                        <li class="nav-item">
                            <a tabindex="-1" class="nav-link" data-toggle="tab" href="#" role="tab">
                                <span class="icon_brand font-2xl"></span>
                            </a>
                        </li>
                    {% endif %}
                </ul>
                <!-- Tab panes-->

                <div class="tab-content container-fluid">
                    <div class="tab-pane active" id="loja" role="tabpanel">
                        <!-- Dados da loja -->
                        {% if 'acessar_pg_dev' in request.session.usr_info.pt_funcao %}
                            <div class="mt-2">
                                <span class="text-uppercase font-weight-semibold">Dados 1:</span>
                                <div class="progress">
                                    <div class="progress-bar progress-bar-striped bg-danger" role="progressbar" style="width: 25%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </div>

                            <div class="mt-2">
                                <span class="text-uppercase font-weight-semibold">Dados 2:</span>
                                <div class="progress">
                                    <div class="progress-bar progress-bar-striped bg-info" role="progressbar" style="width: 75%" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </div>

                            <div class="mt-2">
                                <span class="text-uppercase font-weight-semibold">Dados 3:</span>
                                <div class="progress">
                                    <div class="progress-bar  bg-success" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </div>
                        {% endif %}
                    </div><!-- .tab-pane -->
                    <p class="small text-muted text-uppercase font-weight-bold mt-4 mb-2">
                        <a tabindex="-1" href="#logout">
                            <span>Sair</span>
                        </a>
                    </p>
                </div>


            </aside>
        {% endblock %}

    </div>
{% endblock %}

{% block app_footer %}
    <footer class="app-footer">
        <div class="d-flex justify-content-between align-items-center">
            <div></div>

            <!-- Logo Inteliger -->
            <div class="d-flex align-items-center">
                <a target="_blank" class="small text-muted">Powered by</a>
                <a href="http://www.inteliger.com.br" target="_blank">
                    <img src="{% static 'img/logos_e_banners/logo_inteliger.svg' %}" alt="Logo Inteliger" width="90">
                </a>
            </div>

            <!-- Link versão -->
            <div class="align-middle">
                <a href="#" class="small text-muted" data-toggle="modal" data-target="#modalVersaoAtual">
                    Versão {{ versao_atual.versao.codigo }}
                </a>
            </div>
        </div>
    </footer>
{% endblock %}

{% block modais %}
{% endblock %}

<!-- Jquery v3.5.1 -->
<script type="text/javascript" src="{% static 'js/jquery/js/jquery_3.5.1v.min.js' %}"></script>

<!-- Jquery UI -->
<script type="text/javascript" src="{% static 'js/jquery/js/jquery-ui.min.js' %}"></script>

<!-- Loader js -->
<script type="text/javascript" src="{% static 'js/utilitarios/loader/loader.js' %}"></script>

{% block importacoes_js %}
    <!-- Toastr, alertas de sucesso e erros JS -->
    <script type="text/javascript" src="{% static 'toastr/js/toastr.js' %}"></script>

    <!-- Popper js -->
    <script type="text/javascript" src="{% static 'js/popper/js/popper.min.js' %}"></script>

    <!-- Bootstrap js -->
    <script type="text/javascript" src="{% static 'bootstrap-4.4.1/dist/js/bootstrap.min.js' %}"></script>

    <!-- coreui@ para ativar funcionalidade aos asidebar -->
    <script type="text/javascript" src="{% static '@coreui/coreui-pro/dist/js/coreui.js' %}"></script>

    <!-- select2 js -->
    <script type="text/javascript" src="{% static 'select2/js/select2.min.js' %}"></script>

    <!-- Máscaras do jquery com regexp -->
    <script type="text/javascript" src="{% static 'js/utilitarios/mascara/mask.js' %}"></script>

    <!-- Padronização de cadastro js -->
    <script type="text/javascript" src="{% static 'js/padronizacao_cadastro/padronizacao_cadastro.js' %}"></script>

    <!-- Javascript para exportação de arquivos -->
    <script type="text/javascript" src="{% static 'js/utilitarios/exportar/jszip.js' %}"></script>

    <!-- Padronização do componente de tabelas -->
    <script type="text/javascript" src="{% static 'devextreme/js/padronizacao_tabelas.js' %}"></script>

    <!-- Componente de tabelas -->
    <script type="text/javascript" src="{% static 'devextreme/js/datatables.min.js' %}"></script>

    <!-- Imprimir js -->
    <script type="text/javascript" src="{% static 'js/utilitarios/exportar_imprimir/print.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/utilitarios/exportar_imprimir/printThis.js' %}"></script>

    <!-- Exportar pdf js -->
    <script type="text/javascript" src="{% static 'js/utilitarios/exportar_pdf/pdf.min.js' %}"></script>

    <!-- Popover js -->
    <script type="text/javascript" src="{% static 'js/popover/popovers.js' %}"></script>

    <!-- função para formatação de nome -->
    <script src="{% static 'js/utilitarios/formatar/title.js' %}"></script>
{% endblock %}

<script>

    /**
     * Exemplo de uso: "2020-05-28".formatarInputDate()
     * @return {string}
     */
    String.prototype.formatarInputDate = function(){
        if(this.length === 10)
            if(this.indexOf('-') > -1)
                if(this.split('-').length===3){
                    let formatado = this.split('-');
                    formatado = [formatado[2], formatado[1], formatado[0]];
                    formatado = formatado.join('/');
                    return formatado;
                }
    };

    /**
     * Exibindo erro ao console para visualizar a linha e o momento que foi alertado erro sem interromper a execução do JavaScript
     * @return {string}
     */
    function consoleLogErro(Erro){
        console.groupCollapsed("Erro ao carregar dados, o campo será atribuído em string vazia ");
        console.error("Falta de dados em "+ Erro);
        console.groupEnd();
        return "";
    }

    /**
     * @return {string}
     */
    function retornaDataHoraAtual(){
        function pad(s) {
            return (s < 10) ? '0' + s : s;
        }
        var date = new Date();
        return [date.getHours(), date.getMinutes()].map(pad).join(':');
    }

    function idleLogout() {
        let t;
        let eventos = ['load', 'mousemove', 'mousedown', 'touchstart', 'click', 'keypress', 'scroll'];

        for (let i = 0; i < eventos.length; i++)
            window.addEventListener(eventos[i], function () {
                resetTimer();
            }, false);

        function resetTimer() {
            clearTimeout(t);

            t = setTimeout(abra_modal_atualizacao_de_usuario, 300000);  // time is in milliseconds
        }
    }

    // JAVASCRIPT HISTORY
    (function (history) {
        let pushState = history.pushState;
        history.pushState = function (state) {
            if (typeof history.onpushstate == "function") {
                history.onpushstate({state: state});
            } else {
                toastr.error('Você está realizando um método pushState(dados, "title") sem sobrescrever a função em "window.onpushstate".<br>É necessário tal ação para que seja feito atribuição aos campos do HTML de acordo com os dados visualizados pelo history', 'Error não sobreescreveu o window.onpushstate');
                load('off');
            }
            return pushState.apply(history, arguments);
        }
    })(window.history);
    // FIM JAVASCRIPT HISTORY


    $('select').each(function (index, element) {
        let parent = $(".app-body");
        if (element)
            $(element).select2({
                theme: "bootstrap",
                dropdownParent: parent,
            });
    });

    $(window).on('load', function () {
        $("#btn_Abre_Menu_Esquerdo").removeClass("isDisabled");
        load('off');
    });

    //Função para mostrar barra de btn_Abre_Menu_Esquerdo somente quando estourar a tela.
    //Quando clicar em qualquer lugar da página no mobile, fecha o menu.
    $('main').on('click', function () {
        $(".sidebar-show").removeClass("sidebar-show");
        $(".aside-menu-show").removeClass("aside-menu-show");
    });
    $("#btn_Abre_Menu_Direito").click(function () {
        $(".sidebar-show").removeClass("sidebar-show");
    });
    $("#btn_Fecha_Menu_Esquerdo").click(function () {
        $(".aside-menu-show").removeClass("aside-menu-show");
        if (this.value === 0) {
            $(".sidebar-nav").addClass("fixaMenu");
            this.value = 1;
        } else {
            $(".sidebar-nav").removeClass("fixaMenu");
            this.value = 0;
        }
    });
    $("#btn_Abre_Menu_Esquerdo").click(function () {
        if (this.value === 0) {
            $(".sidebar-nav").addClass("fixaMenu");
            $(".sidebar .nav").css("position", "relative");
            //ajustar o feed comunicados conforme abre o menu esquerdo
            $(".menu_lateral").animate({
                width: "-=35"
            }, 200);
            this.value = 1;
        } else {
            $(".sidebar-nav").removeClass("fixaMenu");
            $(".sidebar .nav").css("position", "fixed");
            //ajustar o feed comunicados conforme fecha o menu esquerdo
            $(".menu_lateral").animate({
                width: "+=35"
            }, 200);
            $('li').removeClass('open');
            this.value = 0
        }
    });
</script>

{% block js %}
{% endblock %}

</body>
</html>